/* AJAX Client is Copyright Â© 2018 Rob Clifton-Harvey https://github.com/rcliftonharvey/ajaxclient/ */void 0===Object.values&&Object.defineProperties(Object.prototype,{values:{enumerable:!1,value:function(t){"use strict";var e=[];for(var o in t)t.hasOwnProperty(o)&&e.push(t[o]);return e}}});var _createClass=function(){"use strict";function t(t,e){for(var o=0;o<e.length;++o){var s=e[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,o,s){return o&&t(e.prototype,o),s&&t(e,s),e}}(),_typeof=function(){"use strict";return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}();function _classCallCheck(t,e){"use strict";if(!(t instanceof e))throw new TypeError('Cannot call a class as a function, use "new" to create instance.')}var AJAX={QUIET:0,ERROR:1,WARNING:2,LOG:4,INFO:8,DEBUG:16,STATUS:{INIT:-1,READY:0,CONNECTED:1,REQUESTING:2,RESPONSE:3,RECEIVING:4,SUCCESS:5,FAILURE:6,ABORTED:7,TIMEOUT:8,ERROR:9},TRANSFER:{0:"Unsent",1:"Opened",2:"Headers received",3:"Loading",4:"Done"},Trim:function(t){"use strict";var e=t;return("string"==typeof e||e instanceof String)&&(e=e.replace(/^\s+|\s+$/g,"")),e},Log:function(){"use strict";for(var t="",e=!1,o=!1,s=!1,n=null,A="",i=0;i<arguments.length;++i){var r=arguments[i];if("number"==typeof r||r instanceof Number)o=parseInt(r);else if("string"==typeof r||r instanceof String){var a=r.substr(0,1);t=(a=" "==a?" ":"")+AJAX.Trim(r)}else"object"===(void 0===r?"undefined":_typeof(r))||r instanceof Object?"array"==typeof r||r instanceof Array?s=r:e=r:("boolean"==typeof r||r instanceof Boolean)&&(n=r)}if(!1===o&&(o=AJAX.LOG),!1!==e&&(A=e.socket.options.clientname,null===n&&(n=o<=e.socket.options.debug)),!0===n){var c;switch(o){case AJAX.LOG:c=console.log;break;case AJAX.INFO:c=console.info;break;case AJAX.WARNING:c=console.warn;break;case AJAX.ERROR:c=console.error;break;default:c=console.log}!1===s?c(A+t):c(A+t,1===s.length?s[0]:s)}},Client:function(){"use strict";function t(){_classCallCheck(this,t);var e=this;this.socket=new XMLHttpRequest,this.socket.options={clientname:"AJAX.Client",debug:AJAX.WARNING},this.socket.flags={status:AJAX.STATUS.INIT,error:!1},this.socket.listeners={abort:!1,error:!1,load:!1,loadend:!1,loadstart:!1,progress:!1,timeout:!1},this.on={connect:!1,request:!1,response:!1,receive:!1,success:!1,failure:!1,abort:!1,timeout:!1,error:!1,complete:!1,status:!1},this.socket.setStatusFlag=function(t){AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Status > setStatusFlag() > Called",[t],e.socket.options.debug>=AJAX.INFO),t>=AJAX.STATUS.INIT&&t<=AJAX.STATUS.ERROR?(e.socket.flags.status=t,AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Status > Triggering on.status()",[t],e.socket.options.debug>=AJAX.INFO),!1!==e.on.status?e.on.status(e):AJAX.Log(AJAX.INFO,e,".on.status() > undefined")):AJAX.Log(AJAX.WARNING,e,".on.status() > flag not in valid range",t)};for(var o=0;o<arguments.length;++o){var s=arguments[o];if("number"==typeof s||s instanceof Number){AJAX.Log(AJAX.INFO,this.socket.options.clientname+" > Constructor > Constructor flag found",[s],this.socket.options.debug>=AJAX.INFO);var n=parseInt(s);n>=AJAX.QUIET&&n<=AJAX.DEBUG?(AJAX.Log(AJAX.INFO,this.socket.options.clientname+" > Constructor > Debug flag found",[s],n>=AJAX.INFO),this.debug(n)):AJAX.Log(AJAX.ERROR,this.socket.options.clientname+" > Constructor > Invalid constructor flag",[s],this.socket.options.debug>=AJAX.ERROR)}else if("string"==typeof s||s instanceof String){var A=AJAX.Trim(s);AJAX.Log(AJAX.INFO,this.socket.options.clientname+" > Constructor > String argument found",[A],this.socket.options.debug>=AJAX.INFO),this.name(A)}}AJAX.Log(AJAX.INFO,this.socket.options.clientname+" > Constructor > Done parsing constructor arguments",this.socket.options.debug>=AJAX.INFO),AJAX.Log(AJAX.INFO,this.socket.options.clientname+" > Constructor > Initializing state handler",this.socket.options.debug>=AJAX.INFO),this.socket.onreadystatechange=function(t){if(!0===e.socket.flags.error)return AJAX.Log(AJAX.LOG,e.socket.options.clientname+" > State Handler > Skipping because of former errors",[e.socket.readyState],this.options.debug>=AJAX.LOG),!1;if(AJAX.Log(AJAX.LOG,e.socket.options.clientname+" > State Handler > AJAX Status",[e.socket.readyState,AJAX.TRANSFER[e.socket.readyState]],e.socket.options.debug>=AJAX.LOG),AJAX.Log(AJAX.LOG,e.socket.options.clientname+" > State Handler > HTTP Status",[e.socket.status,e.socket.statusText],e.socket.options.debug>=AJAX.LOG),0===e.socket.readyState)return!0;if(1===e.socket.readyState){if(0===e.socket.status)return e.socket.setStatusFlag(AJAX.STATUS.CONNECTED),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > State Handler > Triggering .on.connect()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.connect?e.on.connect(t):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.connect() > undefined",e.socket.options.debug>=AJAX.INFO),!0}else if(2===e.socket.readyState){if(200===e.socket.status)return e.socket.setStatusFlag(AJAX.STATUS.RESPONSE),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > State Handler > Triggering .on.response()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.response?e.on.response(t):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.response() > undefined",e.socket.options.debug>=AJAX.INFO),!0}else{if(3===e.socket.readyState)return!0;if(4===e.socket.readyState)return!0}e.socket.flags.error=!0,e.socket.setStatusFlag(AJAX.STATUS.ERROR);var o={client:e,readyState:e.socket.readyState,readyStateText:AJAX.TRANSFER[e.socket.readyState],status:e.socket.status,statusText:e.socket.statusText,event:t};return AJAX.Log(AJAX.ERROR,e.socket.options.clientname+" > State Handler > Error occured",[o],e.socket.options.debug>=AJAX.ERROR),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > State Handler > Triggering .on.error()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.error?e.on.error(o):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.error() > undefined",e.socket.options.debug>=AJAX.INFO),!1},this.socket.addEventListener("loadstart",this.socket.listeners.loadstart=function(t){AJAX.Log(AJAX.LOG,e.socket.options.clientname+" > Listeners > loadstart",e.socket.options.debug>=AJAX.LOG),e.socket.setStatusFlag(AJAX.STATUS.REQUESTING),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Listeners > Triggering .on.request()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.request?e.on.request(t):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.request() > undefined",e.socket.options.debug>=AJAX.INFO)},!1),this.socket.addEventListener("progress",this.socket.listeners.progress=function(t){!1===e.socket.flags.error&&(AJAX.Log(AJAX.LOG,e.socket.options.clientname+" > Listeners > progress",[(100*t.loaded/t.total).toPrecision(2)+" %"],e.socket.options.debug>=AJAX.LOG),e.socket.setStatusFlag(AJAX.STATUS.RECEIVING),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Listeners > Triggering .on.receive()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.receive?e.on.receive(t):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.receive() > undefined",e.socket.options.debug>=AJAX.INFO))},!1),this.socket.addEventListener("load",this.socket.listeners.load=function(t){AJAX.Log(AJAX.LOG,e.socket.options.clientname+" > Listeners > load",e.socket.options.debug>=AJAX.LOG),t.target.status<400?(AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Listeners > Transfer closed with no errors",e.socket.options.debug>=AJAX.INFO),e.socket.setStatusFlag(AJAX.STATUS.SUCCESS),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Listeners > Triggering .on.success()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.success?e.on.success(t):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.success() > undefined",e.socket.options.debug>=AJAX.INFO)):(AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Listeners > Transfer closed with errors",e.socket.options.debug>=AJAX.INFO),e.socket.setStatusFlag(AJAX.STATUS.FAILURE),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Listeners > Triggering .on.failure()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.failure?e.on.failure(t):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.failure() > undefined",e.socket.options.debug>=AJAX.INFO))},!1),this.socket.addEventListener("abort",this.socket.listeners.abort=function(t){AJAX.Log(AJAX.LOG,e.socket.options.clientname+" > Listeners > abort",e.socket.options.debug>=AJAX.LOG),e.socket.setStatusFlag(AJAX.STATUS.ABORTED),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Listeners > Triggering .on.abort()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.abort?e.on.abort(t):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.abort() > undefined",e.socket.options.debug>=AJAX.INFO)},!1),this.socket.addEventListener("timeout",this.socket.listeners.timeout=function(t){AJAX.Log(AJAX.LOG,e.socket.options.clientname+" > Listeners > timeout",e.socket.options.debug>=AJAX.LOG),e.socket.setStatusFlag(AJAX.STATUS.TIMEOUT),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Listeners > Triggering .on.timeout()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.timeout?e.on.timeout(t):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.timeout() > undefined",e.socket.options.debug>=AJAX.INFO)},!1),this.socket.addEventListener("loadend",this.socket.listeners.loadend=function(t){AJAX.Log(AJAX.LOG,e.socket.options.clientname+" > Listeners > loadend",e.socket.options.debug>=AJAX.LOG),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Listeners > Triggering .on.complete()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.complete?e.on.complete(t):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.complete() > undefined",e.socket.options.debug>=AJAX.INFO)},!1),this.socket.addEventListener("error",this.socket.listeners.error=function(t){AJAX.Log(AJAX.ERROR,e.socket.options.clientname+" > Listeners > error",e.socket.options.debug>=AJAX.ERROR),e.socket.setStatusFlag(AJAX.STATUS.ERROR),AJAX.Log(AJAX.INFO,e.socket.options.clientname+" > Listeners > Triggering .on.error()",e.socket.options.debug>=AJAX.INFO),!1!==e.on.error?e.on.error(t):AJAX.Log(AJAX.INFO,e.socket.options.clientname+".on.error() > undefined",e.socket.options.debug>=AJAX.INFO)},!1),this.socket.setStatusFlag(AJAX.STATUS.READY),AJAX.Log(AJAX.LOG,this.socket.options.clientname+" > Constructor > AJAX.Client created",this.socket.options.debug>=AJAX.LOG)}return _createClass(t,[{key:"name",value:function(){if(AJAX.Log(AJAX.INFO,this,".name() > Called",[arguments]),arguments.length>0){var t=arguments[0];if("string"==typeof t||t instanceof String){var e=AJAX.Trim(t),o=this.socket.options.clientname;AJAX.Log(AJAX.INFO,this,".name() > String argument found",[e]),""!==e?this.socket.options.clientname=e:(AJAX.Log(AJAX.INFO,this,".name() > String argument empty, removing name"),this.socket.options.clientname="AJAX.Client")}AJAX.Log(AJAX.LOG,o+".name() > Name updated",[this.socket.options.clientname],this.socket.options.debug>=AJAX.LOG)}return this.socket.options.clientname}},{key:"debug",value:function(){if(AJAX.Log(AJAX.INFO,this,".debug() > Called",[arguments]),arguments.length>0){for(var t=0;t<arguments.length;++t){var e=arguments[t];if("boolean"==typeof e||e instanceof Boolean)AJAX.Log(AJAX.INFO,this,".debug() > Bool argument found",[e]),this.socket.options.debug=!0===e?AJAX.DEBUG:AJAX.QUIET;else if("number"==typeof e||e instanceof Number){var o=parseInt(e);AJAX.Log(AJAX.INFO,this,".debug() > Number argument found",[e]),[AJAX.QUIET,AJAX.ERROR,AJAX.WARNING,AJAX.LOG,AJAX.INFO,AJAX.DEBUG].indexOf(o)>-1&&(this.socket.options.debug=o)}}AJAX.Log(AJAX.LOG,this,".debug() > Value updated",[this.socket.options.debug],this.socket.options.debug>=AJAX.LOG)}return this.socket.options.debug}},{key:"timeout",value:function(){if(AJAX.Log(AJAX.INFO,this,".timeout() > Called",[arguments]),arguments.length>0){var t=arguments[0];if("boolean"==typeof t||t instanceof Boolean){if(AJAX.Log(AJAX.INFO,this,".timeout() > Bool argument found",[t]),!1!==t)return AJAX.Log(AJAX.WAWRNING,this,".timeout() > Bool argument can only be false",[t]),AJAX.Log(AJAX.LOG,this,".timeout() > Value NOT updated"),this.socket.timeout;this.socket.timeout=0}else if("number"==typeof t||t instanceof Number){var e=parseInt(t);AJAX.Log(AJAX.INFO,this,".timeout() > Number argument found",[e]),e<0&&(e=Math.abs(e),AJAX.Log(AJAX.WARNING,this,".timeout() > Number argument was -"+e+" < 0 so was inverted",[e])),this.socket.timeout=e}AJAX.Log(AJAX.LOG,this,".timeout() > Value updated",[this.socket.timeout])}return this.socket.timeout}},{key:"abort",value:function(){AJAX.Log(AJAX.INFO,this,".abort() > Called"),this.socket.abort()}},{key:"status",value:function(){return AJAX.Log(AJAX.INFO,this,".status() > Called",[this.socket.flags.status]),parseInt(this.socket.flags.status)}},{key:"statusName",value:function(){for(var t="undefined",e=0;e<Object.values(AJAX.STATUS).length;++e)Object.values(AJAX.STATUS)[e]===this.socket.flags.status&&(t=Object.keys(AJAX.STATUS)[e]);return t=t.substr(0,1).toUpperCase()+t.substr(1).toLowerCase()}},{key:"get",value:function(){if(AJAX.Log(AJAX.INFO,this,".get() > Called"),AJAX.Log(AJAX.INFO,this,".get() > Socket settings",[this.socket.options,arguments]),this.socket){this.socket.flags.error=!1,AJAX.Log(AJAX.LOG,this,".get() > Socket available");for(var t=!1,e=0;e<arguments.length;++e){var o=arguments[e];if("string"==typeof o||o instanceof String){var s=AJAX.Trim(o);AJAX.Log(AJAX.INFO,this,".get() > String argument found",[s]),t=s}}return!1===t?(AJAX.Log(AJAX.ERROR,this,".get() > No valid URL specified, aborting",[arguments]),!1):(AJAX.Log(AJAX.LOG,this,".get() > Opening connection"),this.socket.open("GET",t,!0),AJAX.Log(AJAX.LOG,this,".get() > Sending request"),this.socket.send(),AJAX.Log(AJAX.LOG,this,".get() > Request sent"),!0)}return AJAX.Log(AJAX.ERROR,this,".get() > Socket unavailable",[arguments]),!1}},{key:"post",value:function(){if(AJAX.Log(AJAX.INFO,this,".post() > Called",[arguments]),AJAX.Log(AJAX.INFO,this,".post() > Socket settings",[this.socket.options,arguments]),this.socket){this.socket.flags.error=!1,AJAX.Log(AJAX.LOG,this,".post() > Socket available");for(var t=!1,e=!1,o=0;o<arguments.length;++o){var s=arguments[o];if("string"==typeof s||s instanceof String){var n=AJAX.Trim(s);AJAX.Log(AJAX.INFO,this,".post() > String argument found",[n]);var A=n.split("?");t=AJAX.Trim(A.splice(0,1)),A.length>0&&(e=AJAX.Trim(A.join("?"))),AJAX.Log(AJAX.INFO,this,".post() > URL found?",[t]),AJAX.Log(AJAX.INFO,this,".post() > URL parameters found?",[e])}}return!1===t?(AJAX.Log(AJAX.ERROR,this,".post() > No valid URL specified, aborting",[arguments]),!1):(AJAX.Log(AJAX.LOG,this,".post() > Opening connection"),this.socket.open("POST",t,!0),!1===e?(this.socket.send(),AJAX.Log(AJAX.LOG,this,".post() > Request send without parameters")):("string"==typeof e||e instanceof String)&&(this.socket.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.socket.send(e),AJAX.Log(AJAX.LOG,this,".post() > Request send with parameters")),!0)}return AJAX.Log(AJAX.ERROR,this,".post() > Socket unavailable",[arguments]),!1}}]),t}()};